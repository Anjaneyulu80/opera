---
name: Ansible Lint All YML Files

on:
  workflow_dispatch:
  pull_request:
    branches: [ "main" ]

jobs:
  ansible-lint:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4

      - name: Install Ansible and ansible-lint
        run: |
          python3 -m pip install --upgrade pip
          python3 -m pip nstall ansible ansible-lint
		
      - name: Find all YML files
        run: find . -type f\(-name "*.yml -o -name "*.yaml" \)>yml_files.txt
		
      - name: Run ansible-lint on all YML files
        run: | 
          while IFS= read -r file; do
            echo "Linting $file"
            ansible-lint "$file"
          done < yml_files.txt			

      - name: Run ansible-lint with custom rules
        run: ansible-lint -p ansible/playbook.yml
           
		   
		   
         ansible-lint  playbooks/
