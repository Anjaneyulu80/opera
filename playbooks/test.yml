---
- name: Test playbook for hardcoded passwords
  hosts: localhost
  gather_facts: false

  vars:
    safe_password: "{{ vault_db_password }}"   # ✅ Should NOT trigger
    unsafe_password: "mySuperSecret123"       # ❌ Should trigger CUSTOM001

  tasks:
    - name: Task with templated password
      user:
        name: "templated_user"
        password: "{{ vault_db_password }}"    # ✅ Should NOT trigger

    - name: Task with hardcoded password
      user:
        name: "admin"
        password: "Admin123!"                  # ❌ Should trigger CUSTOM001

    - name: Task with hardcoded secret token
      uri:
        url: "https://example.com/api"
        headers:
          Authorization: "Bearer mysecrettoken" # ❌ Should trigger CUSTOM001

    - name: Task with vault reference
      user:
        name: "vault_user"
        password: "!vault | ..."               # ✅ Should NOT trigger
